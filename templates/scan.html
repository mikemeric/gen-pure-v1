<div class="container">
    <h2>Analyse Gasoil</h2>
    <label>Station :</label>
    <select id="station_select" onchange="document.getElementById('manual_input').style.display = (this.value=='AUTRE')?'block':'none'">
        <option value="Station Alpha">Station Alpha</option>
        <option value="Station Beta">Station Beta</option>
        <option value="AUTRE">-- Saisie Manuelle --</option>
    </select>
    <input type="text" id="manual_input" style="display:none;" placeholder="Nom de la station">
    
    <input type="file" id="image_file" accept="image/*" capture="environment">
    <button onclick="lancerAnalyse()">Analyser</button>
</div>

<script>
async function lancerAnalyse() {
    let station = document.getElementById('station_select').value;
    if(station === 'AUTRE') station = document.getElementById('manual_input').value;
    
    let file = document.getElementById('image_file').files[0];
    let formData = new FormData();
    formData.append('file', file);
    formData.append('station', station);

    let res = await fetch('/api/detection/detect', {method:'POST', body:formData});
    let data = await res.json();
    alert("Statut : " + data.status + "\nEau : " + data.water_present);
}
</script>